var EasyAutocomplete=function(a){return a.main=function(t,e){function n(){return 0===C.length?void h.error("Input field doesn't exist."):p.checkDataUrlProperties()?p.checkRequiredProperties()?(i(),void o()):void h.error("Will not work without mentioned properties."):void h.error("One of options variables 'data' or 'url' must be defined.")}function i(){function t(){var t=$("<div>"),e=m.getValue("WRAPPER_CSS_CLASS");p.get("theme")&&""!==p.get("theme")&&(e+=" eac-"+p.get("theme")),p.get("cssClasses")&&""!==p.get("cssClasses")&&(e+=" "+p.get("cssClasses")),""!==v.getTemplateClass()&&(e+=" "+v.getTemplateClass()),t.addClass(e),C.wrap(t),!0===p.get("adjustWidth")&&n()}function n(){var t=C.outerWidth();C.parent().css("width",t)}function e(){C.unwrap()}function i(){var f=$("<div>").addClass(m.getValue("CONTAINER_CLASS"));f.attr("id",s()).prepend($("<ul>")),f.on("show.eac",function(){switch(p.get("list").showAnimation.type){case"slide":var t=p.get("list").showAnimation.time,e=p.get("list").showAnimation.callback;f.find("ul").slideDown(t,e);break;case"fade":t=p.get("list").showAnimation.time,e=p.get("list").showAnimation.callback,f.find("ul").fadeIn(t);break;default:f.find("ul").show()}p.get("list").onShowListEvent()}).on("hide.eac",function(){switch(p.get("list").hideAnimation.type){case"slide":var t=p.get("list").hideAnimation.time,e=p.get("list").hideAnimation.callback;f.find("ul").slideUp(t,e);break;case"fade":t=p.get("list").hideAnimation.time,e=p.get("list").hideAnimation.callback,f.find("ul").fadeOut(t,e);break;default:f.find("ul").hide()}p.get("list").onHideListEvent()}).on("selectElement.eac",function(){f.find("ul li").removeClass("selected"),f.find("ul li").eq(b).addClass("selected"),p.get("list").onSelectItemEvent()}).on("loadElements.eac",function(t,i,o){var a="",e=f.find("ul");e.empty().detach(),A=[];for(var r=0,s=0,n=i.length;s<n;s+=1){var c=i[s].data;if(0!==c.length){void 0!==i[s].header&&0<i[s].header.length&&e.append("<div class='eac-category' >"+i[s].header+"</div>");for(var u=0,l=c.length;u<l&&r<i[s].maxListSize;u+=1)a=$("<li><div class='eac-item'></div></li>"),function(){var t=u,e=r,n=i[s].getValue(c[t]);a.find(" > div").on("click",function(){C.val(n).trigger("change"),g(b=e),p.get("list").onClickEvent(),p.get("list").onChooseEvent()}).mouseover(function(){g(b=e),p.get("list").onMouseOverEvent()}).mouseout(function(){p.get("list").onMouseOutEvent()}).html(v.build(d(n,o),c[t]))}(),e.append(a),A.push(c[u]),r+=1}}f.append(e),p.get("list").onLoadEvent()}),C.after(f)}function o(){C.next("."+m.getValue("CONTAINER_CLASS")).remove()}function d(t,e){return p.get("highlightPhrase")&&""!==e?r(t,e):t}function a(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function r(t,e){var n=a(e);return(t+"").replace(new RegExp("("+n+")","gi"),"<b>$1</b>")}C.parent().hasClass(m.getValue("WRAPPER_CSS_CLASS"))&&(o(),e()),t(),i(),S=$("#"+s()),p.get("placeholder")&&C.attr("placeholder",p.get("placeholder"))}function s(){var t=C.attr("id");return m.getValue("CONTAINER_ID")+t}function o(){function t(){E("autocompleteOff",!0)&&s(),e(),n(),i(),o(),a(),r()}function e(){C.focusout(function(){var t,e=C.val();p.get("list").match.caseSensitive||(e=e.toLowerCase());for(var n=0,i=A.length;n<i;n+=1)if(t=p.get("getValue")(A[n]),p.get("list").match.caseSensitive||(t=t.toLowerCase()),t===e)return void g(b=n)})}function n(){C.off("keyup").keyup(function(t){function e(n){function t(){var t={},e=p.get("ajaxSettings")||{};for(var n in e)t[n]=e[n];return t}function i(t,e){return!1===p.get("matchResponseProperty")||("string"==typeof p.get("matchResponseProperty")?e[p.get("matchResponseProperty")]===t:"function"!=typeof p.get("matchResponseProperty")||p.get("matchResponseProperty")(e)===t)}if(!(n.length<p.get("minCharNumber"))){if("list-required"!==p.get("data")){var e=p.get("data"),o=y.init(e);o=y.updateCategories(o,e),l(o=y.processData(o,n),n),0<C.parent().find("li").length?c():u()}var a=t();void 0!==a.url&&""!==a.url||(a.url=p.get("url")),void 0!==a.dataType&&""!==a.dataType||(a.dataType=p.get("dataType")),void 0!==a.url&&"list-required"!==a.url&&(a.url=a.url(n),a.data=p.get("preparePostData")(a.data,n),$.ajax(a).done(function(t){var e=y.init(t);e=y.updateCategories(e,t),e=y.convertXml(e),i(n,t)&&l(e=y.processData(e,n),n),y.checkIfDataExists(e)&&0<C.parent().find("li").length?c():u(),p.get("ajaxCallback")()}).fail(function(){h.warning("Fail to load response data")}).always(function(){}))}}switch(t.keyCode){case 27:u(),f();break;case 38:t.preventDefault(),0<A.length&&0<b&&(b-=1,C.val(p.get("getValue")(A[b])),g(b));break;case 40:t.preventDefault(),0<A.length&&b<A.length-1&&(b+=1,C.val(p.get("getValue")(A[b])),g(b));break;default:if(40<t.keyCode||8===t.keyCode){var n=C.val();!0!==p.get("list").hideOnEmptyPhrase||8!==t.keyCode||""!==n?0<p.get("requestDelay")?(void 0!==d&&clearTimeout(d),d=setTimeout(function(){e(n)},p.get("requestDelay"))):e(n):u()}}})}function i(){C.on("keydown",function(t){return 38===(t=t||window.event).keyCode?!(suppressKeypress=!0):void 0}).keydown(function(t){13===t.keyCode&&-1<b&&(C.val(p.get("getValue")(A[b])),p.get("list").onKeyEnterEvent(),p.get("list").onChooseEvent(),b=-1,u(),t.preventDefault())})}function o(){C.off("keypress")}function a(){C.focus(function(){""!==C.val()&&0<A.length&&(b=-1,c())})}function r(){C.blur(function(){setTimeout(function(){b=-1,u()},250)})}function s(){C.attr("autocomplete","off")}t()}function c(){S.trigger("show.eac")}function u(){S.trigger("hide.eac")}function g(t){S.trigger("selectElement.eac",t)}function l(t,e){S.trigger("loadElements.eac",[t,e])}function f(){C.trigger("blur")}var d,m=new a.Constans,p=new a.Configuration(e),h=new a.Logger,v=new a.Template(e.template),y=new a.ListBuilderService(p,a.proccess),E=p.equals,C=t,S="",A=[],b=-1;a.consts=m,this.getConstants=function(){return m},this.getConfiguration=function(){return p},this.getContainer=function(){return S},this.getSelectedItemIndex=function(){return b},this.getItems=function(){return A},this.getItemData=function(t){return A.length<t||void 0===A[t]?-1:A[t]},this.getSelectedItemData=function(){return this.getItemData(b)},this.build=function(){i()},this.init=function(){n()}},a.eacHandles=[],a.getHandle=function(t){return a.eacHandles[t]},a.inputHasId=function(t){return void 0!==$(t).attr("id")&&0<$(t).attr("id").length},a.assignRandomId=function(t){for(var e="";e="eac-"+Math.floor(1e4*Math.random()),0!==$("#"+e).length;);elementId=a.consts.getValue("CONTAINER_ID")+e,$(t).attr("id",e)},a.setHandle=function(t,e){a.eacHandles[e]=t},a}((EasyAutocomplete=function(t){return t.Template=function(t){var i={basic:{type:"basic",method:function(t){return t},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(t){return t+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(t){return t},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(t){return t},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(t){return t},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}},e=function(t){var e,n=t.fields;return"description"===t.type?(e=i.description.method,"string"==typeof n.description?e=function(t,e){return t+" - <span>"+e[n.description]+"</span>"}:"function"==typeof n.description&&(e=function(t,e){return t+" - <span>"+n.description(e)+"</span>"}),e):"iconRight"===t.type?("string"==typeof n.iconSrc?e=function(t,e){return t+"<img class='eac-icon' src='"+e[n.iconSrc]+"' />"}:"function"==typeof n.iconSrc&&(e=function(t,e){return t+"<img class='eac-icon' src='"+n.iconSrc(e)+"' />"}),e):"iconLeft"===t.type?("string"==typeof n.iconSrc?e=function(t,e){return"<img class='eac-icon' src='"+e[n.iconSrc]+"' />"+t}:"function"==typeof n.iconSrc&&(e=function(t,e){return"<img class='eac-icon' src='"+n.iconSrc(e)+"' />"+t}),e):"links"===t.type?("string"==typeof n.link?e=function(t,e){return"<a href='"+e[n.link]+"' >"+t+"</a>"}:"function"==typeof n.link&&(e=function(t,e){return"<a href='"+n.link(e)+"' >"+t+"</a>"}),e):"custom"===t.type?t.method:i.basic.method},n=function(t){return t&&t.type&&t.type&&i[t.type]?e(t):i.basic.method},o=function(t){var e,n=function(){return""};return t&&t.type&&t.type&&i[t.type]?(e=i[t.type].cssClass,function(){return e}):n};this.getTemplateClass=o(t),this.build=n(t)},t}((EasyAutocomplete=function(c){return c.proccess=function(a,e,t){function n(t,e){var n=[];if(a.get("list").match.enabled)for(var i=0,o=t.length;i<o;i+=1)r(a.get("getValue")(t[i]),e)&&n.push(t[i]);else n=t;return n}function r(t,e){return a.get("list").match.caseSensitive||("string"==typeof t&&(t=t.toLowerCase()),e=e.toLowerCase()),!!a.get("list").match.method(t,e)}function i(t){return void 0!==e.maxNumberOfElements&&t.length>e.maxNumberOfElements&&(t=t.slice(0,e.maxNumberOfElements)),t}function o(t){return a.get("list").sort.enabled&&t.sort(a.get("list").sort.method),t}c.proccess.match=r;var s=e.data;return o(s=i(s=n(s,t)))},c}((EasyAutocomplete=function(t){return t.ListBuilderService=function(r,o){function a(n,i){function t(){var t,e={};return void 0!==n.xmlElementName&&(e.xmlElementName=n.xmlElementName),void 0!==n.listLocation?t=n.listLocation:void 0!==r.get("listLocation")&&(t=r.get("listLocation")),void 0!==t?"string"==typeof t?e.data=$(i).find(t):"function"==typeof t&&(e.data=t(i)):e.data=i,e}function e(){var t={};return void 0!==n.listLocation?"string"==typeof n.listLocation?t.data=i[n.listLocation]:"function"==typeof n.listLocation&&(t.data=n.listLocation(i)):t.data=i,t}var o={};if(o="XML"===r.get("dataType").toUpperCase()?t():e(),void 0!==n.header&&(o.header=n.header),void 0!==n.maxNumberOfElements&&(o.maxNumberOfElements=n.maxNumberOfElements),void 0!==r.get("list").maxNumberOfElements&&(o.maxListSize=r.get("list").maxNumberOfElements),void 0!==n.getValue)if("string"==typeof n.getValue){var a=n.getValue;o.getValue=function(t){return t[a]}}else"function"==typeof n.getValue&&(o.getValue=n.getValue);else o.getValue=r.get("getValue");return o}function n(t){var e=[];return void 0===t.xmlElementName&&(t.xmlElementName=r.get("xmlElementName")),$(t.data).find(t.xmlElementName).each(function(){e.push(this)}),e}this.init=function(t){var e=[],n={};return n.data=r.get("listLocation")(t),n.getValue=r.get("getValue"),n.maxListSize=r.get("list").maxNumberOfElements,e.push(n),e},this.updateCategories=function(t,e){if(r.get("categoriesAssigned")){t=[];for(var n=0;n<r.get("categories").length;n+=1){var i=a(r.get("categories")[n],e);t.push(i)}}return t},this.convertXml=function(t){if("XML"===r.get("dataType").toUpperCase())for(var e=0;e<t.length;e+=1)t[e].data=n(t[e]);return t},this.processData=function(t,e){for(var n=0,i=t.length;n<i;n+=1)t[n].data=o(r,t[n],e);return t},this.checkIfDataExists=function(t){for(var e=0,n=t.length;e<n;e+=1)if(void 0!==t[e].data&&t[e].data instanceof Array&&0<t[e].data.length)return!0;return!1}},t}((EasyAutocomplete=function(t){return t.Constans=function(){var e={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(t){return e[t]}},t}((EasyAutocomplete=function(t){return t.Logger=function(){this.error=function(t){console.log("ERROR: "+t)},this.warning=function(t){console.log("WARNING: "+t)}},t}((EasyAutocomplete=function(t){return t.Configuration=function(a){function t(){if("xml"===a.dataType&&(a.getValue||(a.getValue=function(t){return $(t).text()}),a.list||(a.list={}),a.list.sort||(a.list.sort={}),a.list.sort.method=function(t,e){return(t=a.getValue(t))<(e=a.getValue(e))?-1:e<t?1:0},a.list.match||(a.list.match={}),a.list.match.method=function(t,e){return-1<t.search(e)}),void 0!==a.categories&&a.categories instanceof Array){for(var t=[],e=0,n=a.categories.length;e<n;e+=1){var i=a.categories[e];for(var o in s.categories[0])void 0===i[o]&&(i[o]=s.categories[0][o]);t.push(i)}a.categories=t}}function e(){function o(t,e){var n=t||{};for(var i in t)void 0!==e[i]&&null!==e[i]&&("object"!=typeof e[i]||e[i]instanceof Array?n[i]=e[i]:o(t[i],e[i]));return void 0!==e.data&&null!==e.data&&"object"==typeof e.data&&(n.data=e.data),n}s=o(s,a)}function n(){if("list-required"!==s.url&&"function"!=typeof s.url){var t=s.url;s.url=function(){return t}}if(void 0!==s.ajaxSettings.url&&"function"!=typeof s.ajaxSettings.url){t=s.ajaxSettings.url;s.ajaxSettings.url=function(){return t}}if("string"==typeof s.listLocation){var e=s.listLocation;"XML"===s.dataType.toUpperCase()?s.listLocation=function(t){return $(t).find(e)}:s.listLocation=function(t){return t[e]}}if("string"==typeof s.getValue){var n=s.getValue;s.getValue=function(t){return t[n]}}void 0!==a.categories&&(s.categoriesAssigned=!0)}function i(){void 0!==a.ajaxSettings&&"object"==typeof a.ajaxSettings?s.ajaxSettings=a.ajaxSettings:s.ajaxSettings={}}function o(t){return void 0!==s[t]&&null!==s[t]}function r(i,t){function o(t,e){for(var n in e)void 0===t[n]&&i.log("Property '"+n+"' does not exist in EasyAutocomplete options API."),"object"==typeof t[n]&&-1===$.inArray(n,c)&&o(t[n],e[n])}o(s,t)}var s={data:"list-required",url:"list-required",dataType:"json",listLocation:function(t){return t},xmlElementName:"",getValue:function(t){return t},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},matchResponseProperty:!1,list:{sort:{enabled:!1,method:function(t,e){return(t=s.getValue(t))<(e=s.getValue(e))?-1:e<t?1:0}},maxNumberOfElements:6,hideOnEmptyPhrase:!0,match:{enabled:!1,caseSensitive:!1,method:function(t,e){return-1<t.search(e)}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:!0,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:!0,ajaxSettings:{},preparePostData:function(t){return t},loggerEnabled:!0,template:"",categoriesAssigned:!1,categories:[{maxNumberOfElements:4}]},c=["ajaxSettings","template"];this.get=function(t){return s[t]},this.equals=function(t,e){return!(!o(t)||s[t]!==e)},this.checkDataUrlProperties=function(){return"list-required"!==s.url||"list-required"!==s.data},this.checkRequiredProperties=function(){for(var t in s)if("required"===s[t])return logger.error("Option "+t+" must be defined"),!1;return!0},this.printPropertiesThatDoesntExist=function(t,e){r(t,e)},t(),e(),!0===s.loggerEnabled&&r(console,a),i(),n()},t}(EasyAutocomplete||{}))||{}))||{}))||{}))||{}))||{}))||{});!function(i){i.fn.easyAutocomplete=function(n){return this.each(function(){var t=i(this),e=new EasyAutocomplete.main(t,n);EasyAutocomplete.inputHasId(t)||EasyAutocomplete.assignRandomId(t),e.init(),EasyAutocomplete.setHandle(e,t.attr("id"))})},i.fn.getSelectedItemIndex=function(){var t=i(this).attr("id");return void 0!==t?EasyAutocomplete.getHandle(t).getSelectedItemIndex():-1},i.fn.getItems=function(){var t=i(this).attr("id");return void 0!==t?EasyAutocomplete.getHandle(t).getItems():-1},i.fn.getItemData=function(t){var e=i(this).attr("id");return void 0!==e&&-1<t?EasyAutocomplete.getHandle(e).getItemData(t):-1},i.fn.getSelectedItemData=function(){var t=i(this).attr("id");return void 0!==t?EasyAutocomplete.getHandle(t).getSelectedItemData():-1}}(jQuery);