var EasyAutocomplete=function(o){return o.main=function r(e,t){function n(){0!==C.length?p.checkDataUrlProperties()?p.checkRequiredProperties()?(i(),a()):h.error("Will not work without mentioned properties."):h.error("One of options variables 'data' or 'url' must be defined."):h.error("Input field doesn't exist.")}function i(){function e(){var e=$("<div>"),t=m.getValue("WRAPPER_CSS_CLASS");p.get("theme")&&""!==p.get("theme")&&(t+=" eac-"+p.get("theme")),p.get("cssClasses")&&""!==p.get("cssClasses")&&(t+=" "+p.get("cssClasses")),""!==y.getTemplateClass()&&(t+=" "+y.getTemplateClass()),e.addClass(t),C.wrap(e),!0===p.get("adjustWidth")&&n()}function n(){var e=C.outerWidth();C.parent().css("width",e)}function t(){C.unwrap()}function i(){var f=$("<div>").addClass(m.getValue("CONTAINER_CLASS"));f.attr("id",s()).prepend($("<ul>")),f.on("show.eac",function(){switch(p.get("list").showAnimation.type){case"slide":var e=p.get("list").showAnimation.time,t=p.get("list").showAnimation.callback;f.find("ul").slideDown(e,t);break;case"fade":e=p.get("list").showAnimation.time,t=p.get("list").showAnimation.callback,f.find("ul").fadeIn(e);break;default:f.find("ul").show()}p.get("list").onShowListEvent()}).on("hide.eac",function(){switch(p.get("list").hideAnimation.type){case"slide":var e=p.get("list").hideAnimation.time,t=p.get("list").hideAnimation.callback;f.find("ul").slideUp(e,t);break;case"fade":e=p.get("list").hideAnimation.time,t=p.get("list").hideAnimation.callback,f.find("ul").fadeOut(e,t);break;default:f.find("ul").hide()}p.get("list").onHideListEvent()}).on("selectElement.eac",function(){f.find("ul li").removeClass("selected"),f.find("ul li").eq(b).addClass("selected"),p.get("list").onSelectItemEvent()}).on("loadElements.eac",function(e,i,a){var o="",t=f.find("ul");t.empty().detach(),A=[];for(var r=0,s=0,n=i.length;s<n;s+=1){var u=i[s].data;if(0!==u.length){i[s].header!==undefined&&0<i[s].header.length&&t.append("<div class='eac-category' >"+i[s].header+"</div>");for(var c=0,l=u.length;c<l&&r<i[s].maxListSize;c+=1)o=$("<li><div class='eac-item'></div></li>"),function(){var e=c,t=r,n=i[s].getValue(u[e]);o.find(" > div").on("click",function(){C.val(n).trigger("change"),g(b=t),p.get("list").onClickEvent(),p.get("list").onChooseEvent()}).mouseover(function(){g(b=t),p.get("list").onMouseOverEvent()}).mouseout(function(){p.get("list").onMouseOutEvent()}).html(y.build(d(n,a),u[e]))}(),t.append(o),A.push(u[c]),r+=1}}f.append(t),p.get("list").onLoadEvent()}),C.after(f)}function a(){C.next("."+m.getValue("CONTAINER_CLASS")).remove()}function d(e,t){return p.get("highlightPhrase")&&""!==t?r(e,t):e}function o(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function r(e,t){var n=o(t);return(e+"").replace(new RegExp("("+n+")","gi"),"<b>$1</b>")}C.parent().hasClass(m.getValue("WRAPPER_CSS_CLASS"))&&(a(),t()),e(),i(),S=$("#"+s()),p.get("placeholder")&&C.attr("placeholder",p.get("placeholder"))}function s(){var e=C.attr("id");return e=m.getValue("CONTAINER_ID")+e}function a(){function e(){E("autocompleteOff",!0)&&s(),t(),n(),i(),a(),o(),r()}function t(){C.focusout(function(){var e,t=C.val();p.get("list").match.caseSensitive||(t=t.toLowerCase());for(var n=0,i=A.length;n<i;n+=1)if(e=p.get("getValue")(A[n]),p.get("list").match.caseSensitive||(e=e.toLowerCase()),e===t)return void g(b=n)})}function n(){C.off("keyup").keyup(function(e){function t(n){function e(){var e={},t=p.get("ajaxSettings")||{};for(var n in t)e[n]=t[n];return e}function i(e,t){return!1===p.get("matchResponseProperty")||("string"==typeof p.get("matchResponseProperty")?t[p.get("matchResponseProperty")]===e:"function"!=typeof p.get("matchResponseProperty")||p.get("matchResponseProperty")(t)===e)}if(!(n.length<p.get("minCharNumber"))){if("list-required"!==p.get("data")){var t=p.get("data"),a=v.init(t);a=v.updateCategories(a,t),l(a=v.processData(a,n),n),0<C.parent().find("li").length?u():c()}var o=e();o.url!==undefined&&""!==o.url||(o.url=p.get("url")),o.dataType!==undefined&&""!==o.dataType||(o.dataType=p.get("dataType")),o.url!==undefined&&"list-required"!==o.url&&(o.url=o.url(n),o.data=p.get("preparePostData")(o.data,n),$.ajax(o).done(function(e){var t=v.init(e);t=v.updateCategories(t,e),t=v.convertXml(t),i(n,e)&&l(t=v.processData(t,n),n),v.checkIfDataExists(t)&&0<C.parent().find("li").length?u():c(),p.get("ajaxCallback")()}).fail(function(){h.warning("Fail to load response data")}).always(function(){}))}}switch(e.keyCode){case 27:c(),f();break;case 38:e.preventDefault(),0<A.length&&0<b&&(b-=1,C.val(p.get("getValue")(A[b])),g(b));break;case 40:e.preventDefault(),0<A.length&&b<A.length-1&&(b+=1,C.val(p.get("getValue")(A[b])),g(b));break;default:if(40<e.keyCode||8===e.keyCode){var n=C.val();!0!==p.get("list").hideOnEmptyPhrase||8!==e.keyCode||""!==n?0<p.get("requestDelay")?(d!==undefined&&clearTimeout(d),d=setTimeout(function(){t(n)},p.get("requestDelay"))):t(n):c()}}})}function i(){C.on("keydown",function(e){if(38===(e=e||window.event).keyCode)return!(suppressKeypress=!0)}).keydown(function(e){13===e.keyCode&&-1<b&&(C.val(p.get("getValue")(A[b])),p.get("list").onKeyEnterEvent(),p.get("list").onChooseEvent(),b=-1,c(),e.preventDefault())})}function a(){C.off("keypress")}function o(){C.focus(function(){""!==C.val()&&0<A.length&&(b=-1,u())})}function r(){C.blur(function(){setTimeout(function(){b=-1,c()},250)})}function s(){C.attr("autocomplete","off")}e()}function u(){S.trigger("show.eac")}function c(){S.trigger("hide.eac")}function g(e){S.trigger("selectElement.eac",e)}function l(e,t){S.trigger("loadElements.eac",[e,t])}function f(){C.trigger("blur")}var d,m=new o.Constans,p=new o.Configuration(t),h=new o.Logger,y=new o.Template(t.template),v=new o.ListBuilderService(p,o.proccess),E=p.equals,C=e,S="",A=[],b=-1;o.consts=m,this.getConstants=function(){return m},this.getConfiguration=function(){return p},this.getContainer=function(){return S},this.getSelectedItemIndex=function(){return b},this.getItems=function(){return A},this.getItemData=function(e){return A.length<e||A[e]===undefined?-1:A[e]},this.getSelectedItemData=function(){return this.getItemData(b)},this.build=function(){i()},this.init=function(){n()}},o.eacHandles=[],o.getHandle=function(e){return o.eacHandles[e]},o.inputHasId=function(e){return $(e).attr("id")!==undefined&&0<$(e).attr("id").length},o.assignRandomId=function(e){for(var t="";t="eac-"+Math.floor(1e4*Math.random()),0!==$("#"+t).length;);elementId=o.consts.getValue("CONTAINER_ID")+t,$(e).attr("id",t)},o.setHandle=function(e,t){o.eacHandles[t]=e},o}((EasyAutocomplete=function(e){return e.Template=function o(e){var i={basic:{type:"basic",method:function(e){return e},cssClass:""},description:{type:"description",fields:{description:"description"},method:function(e){return e+" - description"},cssClass:"eac-description"},iconLeft:{type:"iconLeft",fields:{icon:""},method:function(e){return e},cssClass:"eac-icon-left"},iconRight:{type:"iconRight",fields:{iconSrc:""},method:function(e){return e},cssClass:"eac-icon-right"},links:{type:"links",fields:{link:""},method:function(e){return e},cssClass:""},custom:{type:"custom",method:function(){},cssClass:""}},t=function(e){var t,n=e.fields;return"description"===e.type?(t=i.description.method,"string"==typeof n.description?t=function(e,t){return e+" - <span>"+t[n.description]+"</span>"}:"function"==typeof n.description&&(t=function(e,t){return e+" - <span>"+n.description(t)+"</span>"}),t):"iconRight"===e.type?("string"==typeof n.iconSrc?t=function(e,t){return e+"<img class='eac-icon' src='"+t[n.iconSrc]+"' />"}:"function"==typeof n.iconSrc&&(t=function(e,t){return e+"<img class='eac-icon' src='"+n.iconSrc(t)+"' />"}),t):"iconLeft"===e.type?("string"==typeof n.iconSrc?t=function(e,t){return"<img class='eac-icon' src='"+t[n.iconSrc]+"' />"+e}:"function"==typeof n.iconSrc&&(t=function(e,t){return"<img class='eac-icon' src='"+n.iconSrc(t)+"' />"+e}),t):"links"===e.type?("string"==typeof n.link?t=function(e,t){return"<a href='"+t[n.link]+"' >"+e+"</a>"}:"function"==typeof n.link&&(t=function(e,t){return"<a href='"+n.link(t)+"' >"+e+"</a>"}),t):"custom"===e.type?e.method:i.basic.method},n=function(e){return e&&e.type&&e.type&&i[e.type]?t(e):i.basic.method},a=function(e){var t,n=function(){return""};return e&&e.type&&e.type&&i[e.type]?(t=i[e.type].cssClass,function(){return t}):n};this.getTemplateClass=a(e),this.build=n(e)},e}((EasyAutocomplete=function(u){return u.proccess=function c(o,t,e){function n(e,t){var n=[];if(o.get("list").match.enabled)for(var i=0,a=e.length;i<a;i+=1)r(o.get("getValue")(e[i]),t)&&n.push(e[i]);else n=e;return n}function r(e,t){return o.get("list").match.caseSensitive||("string"==typeof e&&(e=e.toLowerCase()),t=t.toLowerCase()),!!o.get("list").match.method(e,t)}function i(e){return t.maxNumberOfElements!==undefined&&e.length>t.maxNumberOfElements&&(e=e.slice(0,t.maxNumberOfElements)),e}function a(e){return o.get("list").sort.enabled&&e.sort(o.get("list").sort.method),e}u.proccess.match=r;var s=t.data;return s=a(s=i(s=n(s,e)))},u}((EasyAutocomplete=function(e){return e.ListBuilderService=function t(r,a){function o(n,i){function e(){var e,t={};return n.xmlElementName!==undefined&&(t.xmlElementName=n.xmlElementName),n.listLocation!==undefined?e=n.listLocation:r.get("listLocation")!==undefined&&(e=r.get("listLocation")),e!==undefined?"string"==typeof e?t.data=$(i).find(e):"function"==typeof e&&(t.data=e(i)):t.data=i,t}function t(){var e={};return n.listLocation!==undefined?"string"==typeof n.listLocation?e.data=i[n.listLocation]:"function"==typeof n.listLocation&&(e.data=n.listLocation(i)):e.data=i,e}var a={};if(a="XML"===r.get("dataType").toUpperCase()?e():t(),n.header!==undefined&&(a.header=n.header),n.maxNumberOfElements!==undefined&&(a.maxNumberOfElements=n.maxNumberOfElements),r.get("list").maxNumberOfElements!==undefined&&(a.maxListSize=r.get("list").maxNumberOfElements),n.getValue!==undefined)if("string"==typeof n.getValue){var o=n.getValue;a.getValue=function(e){return e[o]}}else"function"==typeof n.getValue&&(a.getValue=n.getValue);else a.getValue=r.get("getValue");return a}function n(e){var t=[];return e.xmlElementName===undefined&&(e.xmlElementName=r.get("xmlElementName")),$(e.data).find(e.xmlElementName).each(function(){t.push(this)}),t}this.init=function(e){var t=[],n={};return n.data=r.get("listLocation")(e),n.getValue=r.get("getValue"),n.maxListSize=r.get("list").maxNumberOfElements,t.push(n),t},this.updateCategories=function(e,t){if(r.get("categoriesAssigned")){e=[];for(var n=0;n<r.get("categories").length;n+=1){var i=o(r.get("categories")[n],t);e.push(i)}}return e},this.convertXml=function(e){if("XML"===r.get("dataType").toUpperCase())for(var t=0;t<e.length;t+=1)e[t].data=n(e[t]);return e},this.processData=function(e,t){for(var n=0,i=e.length;n<i;n+=1)e[n].data=a(r,e[n],t);return e},this.checkIfDataExists=function(e){for(var t=0,n=e.length;t<n;t+=1)if(e[t].data!==undefined&&e[t].data instanceof Array&&0<e[t].data.length)return!0;return!1}},e}((EasyAutocomplete=function(e){return e.Constans=function n(){var t={CONTAINER_CLASS:"easy-autocomplete-container",CONTAINER_ID:"eac-container-",WRAPPER_CSS_CLASS:"easy-autocomplete"};this.getValue=function(e){return t[e]}},e}((EasyAutocomplete=function(e){return e.Logger=function t(){this.error=function(e){console.log("ERROR: "+e)},this.warning=function(e){console.log("WARNING: "+e)}},e}((EasyAutocomplete=function(e){return e.Configuration=function c(o){function e(){if("xml"===o.dataType&&(o.getValue||(o.getValue=function(e){return $(e).text()}),o.list||(o.list={}),o.list.sort||(o.list.sort={}),o.list.sort.method=function(e,t){return(e=o.getValue(e))<(t=o.getValue(t))?-1:t<e?1:0},o.list.match||(o.list.match={}),o.list.match.method=function(e,t){return-1<e.search(t)}),o.categories!==undefined&&o.categories instanceof Array){for(var e=[],t=0,n=o.categories.length;t<n;t+=1){var i=o.categories[t];for(var a in s.categories[0])i[a]===undefined&&(i[a]=s.categories[0][a]);e.push(i)}o.categories=e}}function t(){function a(e,t){var n=e||{};for(var i in e)t[i]!==undefined&&null!==t[i]&&("object"!=typeof t[i]||t[i]instanceof Array?n[i]=t[i]:a(e[i],t[i]));return t.data!==undefined&&null!==t.data&&"object"==typeof t.data&&(n.data=t.data),n}s=a(s,o)}function n(){if("list-required"!==s.url&&"function"!=typeof s.url){var e=s.url;s.url=function(){return e}}if(s.ajaxSettings.url!==undefined&&"function"!=typeof s.ajaxSettings.url){e=s.ajaxSettings.url;s.ajaxSettings.url=function(){return e}}if("string"==typeof s.listLocation){var t=s.listLocation;"XML"===s.dataType.toUpperCase()?s.listLocation=function(e){return $(e).find(t)}:s.listLocation=function(e){return e[t]}}if("string"==typeof s.getValue){var n=s.getValue;s.getValue=function(e){return e[n]}}o.categories!==undefined&&(s.categoriesAssigned=!0)}function i(){o.ajaxSettings!==undefined&&"object"==typeof o.ajaxSettings?s.ajaxSettings=o.ajaxSettings:s.ajaxSettings={}}function a(e){return s[e]!==undefined&&null!==s[e]}function r(i,e){function a(e,t){for(var n in t)e[n]===undefined&&i.log("Property '"+n+"' does not exist in EasyAutocomplete options API."),"object"==typeof e[n]&&-1===$.inArray(n,u)&&a(e[n],t[n])}a(s,e)}var s={data:"list-required",url:"list-required",dataType:"json",listLocation:function(e){return e},xmlElementName:"",getValue:function(e){return e},autocompleteOff:!0,placeholder:!1,ajaxCallback:function(){},matchResponseProperty:!1,list:{sort:{enabled:!1,method:function(e,t){return(e=s.getValue(e))<(t=s.getValue(t))?-1:t<e?1:0}},maxNumberOfElements:6,hideOnEmptyPhrase:!0,match:{enabled:!1,caseSensitive:!1,method:function(e,t){return-1<e.search(t)}},showAnimation:{type:"normal",time:400,callback:function(){}},hideAnimation:{type:"normal",time:400,callback:function(){}},onClickEvent:function(){},onSelectItemEvent:function(){},onLoadEvent:function(){},onChooseEvent:function(){},onKeyEnterEvent:function(){},onMouseOverEvent:function(){},onMouseOutEvent:function(){},onShowListEvent:function(){},onHideListEvent:function(){}},highlightPhrase:!0,theme:"",cssClasses:"",minCharNumber:0,requestDelay:0,adjustWidth:!0,ajaxSettings:{},preparePostData:function(e){return e},loggerEnabled:!0,template:"",categoriesAssigned:!1,categories:[{maxNumberOfElements:4}]},u=["ajaxSettings","template"];this.get=function(e){return s[e]},this.equals=function(e,t){return!(!a(e)||s[e]!==t)},this.checkDataUrlProperties=function(){return"list-required"!==s.url||"list-required"!==s.data},this.checkRequiredProperties=function(){for(var e in s)if("required"===s[e])return logger.error("Option "+e+" must be defined"),!1;return!0},this.printPropertiesThatDoesntExist=function(e,t){r(e,t)},e(),t(),!0===s.loggerEnabled&&r(console,o),i(),n()},e}(EasyAutocomplete||{}))||{}))||{}))||{}))||{}))||{}))||{});!function(i){i.fn.easyAutocomplete=function(n){return this.each(function(){var e=i(this),t=new EasyAutocomplete.main(e,n);EasyAutocomplete.inputHasId(e)||EasyAutocomplete.assignRandomId(e),t.init(),EasyAutocomplete.setHandle(t,e.attr("id"))})},i.fn.getSelectedItemIndex=function(){var e=i(this).attr("id");return e!==undefined?EasyAutocomplete.getHandle(e).getSelectedItemIndex():-1},i.fn.getItems=function(){var e=i(this).attr("id");return e!==undefined?EasyAutocomplete.getHandle(e).getItems():-1},i.fn.getItemData=function(e){var t=i(this).attr("id");return t!==undefined&&-1<e?EasyAutocomplete.getHandle(t).getItemData(e):-1},i.fn.getSelectedItemData=function(){var e=i(this).attr("id");return e!==undefined?EasyAutocomplete.getHandle(e).getSelectedItemData():-1}}(jQuery);