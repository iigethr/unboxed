var EasyAutocomplete=function(o){return o.main=function r(e,t){function n(){0!==E.length?p.checkDataUrlProperties()?p.checkRequiredProperties()?(a(),i()):m.error("Will not work without mentioned properties."):m.error("One of options variables 'data' or 'url' must be defined."):m.error("Input field doesn't exist.")}function a(){function e(){var e=$("<div>"),t=h.getValue("WRAPPER_CSS_CLASS");p.get("theme")&&""!==p.get("theme")&&(t+=" eac-"+p.get("theme")),p.get("cssClasses")&&""!==p.get("cssClasses")&&(t+=" "+p.get("cssClasses")),""!==v.getTemplateClass()&&(t+=" "+v.getTemplateClass()),e.addClass(t),E.wrap(e),!0===p.get("adjustWidth")&&n()}function n(){var e=E.outerWidth();E.parent().css("width",e)}function t(){E.unwrap()}function a(){var d=$("<div>").addClass(h.getValue("CONTAINER_CLASS"));d.attr("id",s()).prepend($("<ul>")),d.on("show.eac",function(){switch(p.get("list").showAnimation.type){case"slide":var e=p.get("list").showAnimation.time,t=p.get("list").showAnimation.callback;d.find("ul").slideDown(e,t);break;case"fade":e=p.get("list").showAnimation.time,t=p.get("list").showAnimation.callback,d.find("ul").fadeIn(e);break;default:d.find("ul").show()}p.get("list").onShowListEvent()}).on("hide.eac",function(){switch(p.get("list").hideAnimation.type){case"slide":var e=p.get("list").hideAnimation.time,t=p.get("list").hideAnimation.callback;d.find("ul").slideUp(e,t);break;case"fade":e=p.get("list").hideAnimation.time,t=p.get("list").hideAnimation.callback,d.find("ul").fadeOut(e,t);break;default:d.find("ul").hide()}p.get("list").onHideListEvent()}).on("selectElement.eac",function(){d.find("ul li").removeClass("selected"),d.find("ul li").eq(I).addClass("selected"),p.get("list").onSelectItemEvent()}).on("loadElements.eac",function(e,a,i){var o="",t=d.find("ul");t.empty().detach(),A=[];for(var r=0,s=0,n=a.length;s<n;s+=1){var u=a[s].data;if(0!==u.length){a[s].header!==undefined&&0<a[s].header.length&&t.append("<div class='eac-category' >"+a[s].header+"</div>");for(var l=0,c=u.length;l<c&&r<a[s].maxListSize;l+=1)o=$("<li><div class='eac-item'></div></li>"),function(){var e=l,t=r,n=a[s].getValue(u[e]);o.find(" > div").on("click",function(){E.val(n).trigger("change"),g(I=t),p.get("list").onClickEvent(),p.get("list").onChooseEvent()}).mouseover(function(){g(I=t),p.get("list").onMouseOverEvent()}).mouseout(function(){p.get("list").onMouseOutEvent()}).html(v.build(f(n,i),u[e]))}(),t.append(o),A.push(u[l]),r+=1}}d.append(t),p.get("list").onLoadEvent()}),E.after(d)}function i(){E.next("."+h.getValue("CONTAINER_CLASS")).remove()}function f(e,t){return p.get("highlightPhrase")&&""!==t?r(e,t):e}function o(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function r(e,t){var n=o(t);return(e+"").replace(new RegExp("("+n+")","gi"),"<b>$1</b>")}E.parent().hasClass(h.getValue("WRAPPER_CSS_CLASS"))&&(i(),t()),e(),a(),w=$("#"+s()),p.get("placeholder")&&E.attr("placeholder",p.get("placeholder"))}function s(){var e=E.attr("id");return e=h.getValue("CONTAINER_ID")+e}function i(){function e(){C("autocompleteOff",!0)&&s(),t(),n(),a(),i(),o(),r()}function t(){E.focusout(function(){var e,t=E.val();p.get("list").match.caseSensitive||(t=t.toLowerCase());for(var n=0,a=A.length;n<a;n+=1)if(e=p.get("getValue")(A[n]),p.get("list").match.caseSensitive||(e=e.toLowerCase()),e===t)return void g(I=n)})}function n(){E.off("keyup").keyup(function(e){function t(n){function e(){var e={},t=p.get("ajaxSettings")||{};for(var n in t)e[n]=t[n];return e}function a(e,t){return!1===p.get("matchResponseProperty")||("string"==typeof p.get("matchResponseProperty")?t[p.get("matchResponseProperty")]===e:"function"!=typeof p.get("matchResponseProperty")||p.get("matchResponseProperty")(t)===e)}if(!(n.length<p.get("minCharNumber"))){if("list-required"!==p.get("data")){var t=p.get("data"),i=y.init(t);i=y.updateCategories(i,t),c(i=y.processData(i,n),n),0<E.parent().find("li").length?u():l()}var o=e();o.url!==undefined&&""!==o.url||(o.url=p.get("url")),o.dataType!==undefined&&""!==o.dataType||(o.dataType=p.get("dataType")),o.url!==undefined&&"list-required"!==o.url&&(o.url=o.url(n),o.data=p.get("preparePostData")(o.data,n),$.ajax(o).done(function(e){var t=y.init(e);t=y.updateCategories(t,e),t=y.convertXml(t),a(n,e)&&c(t=y.processData(t,n),n),y.checkIfDataExists(t)&&0<E.parent().find("li").length?u():l(),p.get("ajaxCallback")()}).fail(function(){m.warning("Fail to load response data")}).always(function(){}))}}switch(e.keyCode){case 27:l(),d();break;case 38:e.preventDefault(),0<A.length&&0<I&&(I-=1,E.val(p.get("getValue")(A[I])),g(I));break;case 40:e.preventDefault(),0<A.length&&I<A.length-1&&(I+=1,E.val(p.get("getValue")(A[I])),g(I));break;default:if(40<e.keyCode||8===e.keyCode){var n=E.val();!0!==p.get("list").hideOnEmptyPhrase||8!==e.keyCode||""!==n?0<p.get("requestDelay")?(f!==undefined&&clearTimeout(f),f=setTimeout(function(){t(n)},p.get("requestDelay"))):t(n):l()}}})}function a(){E.on("keydown",function(e){if(38===(e=e||window.event).keyCode)return!(suppressKeypress=!0)}).keydown(function(e){13===e.keyCode&&-1<I&&(E.val(p.get("getValue")(A[I])),p.get("list").onKeyEnterEvent(),p.get("list").onChooseEvent(),I=-1,l(),e.preventDefault())})}function i(){E.off("keypress")}function o(){E.focus(function(){""!==E.val()&&0<A.length&&(I=-1,u())})}function r(){E.blur(function(){setTimeout(function(){I=-1,l()},250)})}function s(){E.attr("autocomplete","off")}e()}function u(){w.trigger("show.eac")}function l(){w.trigger("hide.eac")}function g(e){w.trigger("selectElement.eac",e)}function c(e,t){w.trigger("loadElements.eac",[e,t])}function d(){E.trigger("blur")}var f,h=new o.Constans,p=new o.Configuration(t),m=new o.Logger,v=new o.Template(t.template),y=new o.ListBuilderService(p,o.proccess),C=p.equals,E=e,w="",A=[],I=-1;o.consts=h,this.getConstants=function(){return h},this.getConfiguration=function(){return p},this.getContainer=function(){return w},this.getSelectedItemIndex=function(){return I},this.getItems=function(){return A},this.getItemData=function(e){return A.length<e||A[e]===undefined?-1:A[e]},this.getSelectedItemData=function(){return this.getItemData(I)},this.build=function(){a()},this.init=function(){n()}},o.eacHandles=[],o.getHandle=function(e){return o.eacHandles[e]},o.inputHasId=function(e){return $(e).attr("id")!==undefined&&0<$(e).attr("id").length},o.assignRandomId=function(e){for(var t="";t="eac-"+Math.floor(1e4*Math.random()),0!==$("#"+t).length;);elementId=o.consts.getValue("CONTAINER_ID")+t,$(e).attr("id",t)},o.setHandle=function(e,t){o.eacHandles[t]=e},o}(EasyAutocomplete||{});!function(a){a.fn.easyAutocomplete=function(n){return this.each(function(){var e=a(this),t=new EasyAutocomplete.main(e,n);EasyAutocomplete.inputHasId(e)||EasyAutocomplete.assignRandomId(e),t.init(),EasyAutocomplete.setHandle(t,e.attr("id"))})},a.fn.getSelectedItemIndex=function(){var e=a(this).attr("id");return e!==undefined?EasyAutocomplete.getHandle(e).getSelectedItemIndex():-1},a.fn.getItems=function(){var e=a(this).attr("id");return e!==undefined?EasyAutocomplete.getHandle(e).getItems():-1},a.fn.getItemData=function(e){var t=a(this).attr("id");return t!==undefined&&-1<e?EasyAutocomplete.getHandle(t).getItemData(e):-1},a.fn.getSelectedItemData=function(){var e=a(this).attr("id");return e!==undefined?EasyAutocomplete.getHandle(e).getSelectedItemData():-1}}(jQuery);